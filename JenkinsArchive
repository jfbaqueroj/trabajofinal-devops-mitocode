pipeline {
    agent any
        
    stages{

        stage('Archivar el JAR') {

         agent{
           docker{image 'maven:3.6.3-jdk-11-slim'}  
            }
            steps {
            sh 'pwd'
            sh 'ls -la'
            sh 'mvn -B -e -C -T 1C org.apache.maven.plugins:maven-dependency-plugin:3.0.2:go-offline'
            sh 'echo "ejecucion de maven completa. Ubicacion actual: "'                
            sh 'pwd'
            sh 'mvn clean package -Dmaven.test.skip=true'
            sh 'echo "Ubicacion ACTUAL: "'
            sh 'pwd'                     
            sh 'echo "Fin del  step"'
            
            dir("target"){
                sh 'echo "deste target!:"'
                sh 'pwd'
                sh 'ls'
                sh 'cp *.jar' /var/lib/jenkins/workspace/Almacenar_JAR/target 
            }
               dir("/var/lib/jenkins/workspace/Almacenar_JAR/target"){
                sh 'echo "desde el nuevo target!:"'
                sh 'pwd'
                sh 'ls'
               
            }                         
            }
        }
    
    }
#    post {
#        always {        
#           archiveArtifacts artifacts: '**/*.*'
#        }
#    }
}